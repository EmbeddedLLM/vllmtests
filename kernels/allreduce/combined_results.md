# All-Reduce Benchmark Results

Benchmark comparing AITER custom all-reduce, vLLM custom all-reduce, and vLLM quick all-reduce.

# All-Reduce Benchmark Results (World Size: 2)

All times are in milliseconds. -1 indicates the method is not supported/available for that size.

| Size | NCCL | AITER Reg | AITER Unreg | vLLM Custom | Quick FP | Quick INT8 | Quick INT6 | Quick INT4 |
|---|---|---|---|---|---|---|---|---|
| 2KB | 0.085 | 0.055 | 0.042 | 0.034 | 0.029 | 0.037 | 0.039 | 0.037 |
| 32KB | 0.081 | 0.060 | 0.056 | 0.034 | 0.028 | 0.038 | 0.039 | 0.038 |
| 256KB | 0.084 | 0.040 | 0.043 | 0.034 | 0.031 | 0.039 | 0.041 | 0.039 |
| 512KB | 0.090 | 0.043 | 0.046 | 0.038 | 0.036 | 0.040 | 0.041 | 0.039 |
| 1MB | 0.101 | 0.055 | 0.059 | 0.049 | 0.046 | 0.047 | 0.046 | 0.042 |
| 2MB | 0.123 | 0.074 | 0.079 | 0.072 | 0.068 | 0.058 | 0.054 | 0.048 |
| 4MB | 0.177 | 0.121 | 0.125 | 0.116 | 0.114 | 0.081 | 0.072 | 0.061 |
| 8MB | 0.261 | 0.209 | 0.218 | 0.207 | 0.208 | 0.135 | 0.110 | 0.087 |
| 16MB | 0.442 | 0.388 | 0.399 | 0.393 | 0.402 | 0.241 | 0.191 | 0.150 |
| 32MB | 0.810 | 0.742 | 0.760 | 0.745 | 0.766 | 0.448 | 0.358 | 0.276 |
| 64MB | 1.539 | 1.448 | 1.479 | 1.460 | 1.493 | 0.853 | 0.670 | 0.494 |
| 128MB | 2.998 | 2.862 | 2.919 | 2.887 | 2.947 | 1.662 | 1.297 | 0.938 |
| 256MB | 5.822 | 5.680 | 5.800 | 5.750 | 5.849 | 3.280 | 2.562 | 1.837 |
| 512MB | 11.466 | 11.345 | 11.569 | 11.485 | 11.649 | 6.517 | 5.083 | 3.629 |
| 1GB | 22.754 | 22.592 | 23.123 | 22.958 | 23.243 | 12.989 | 10.113 | 7.216 |
| 2GB | 45.355 | 45.147 | 46.209 | 0.006 | 46.495 | 25.928 | 20.187 | 14.370 |

## Performance Summary

### Speedup vs NCCL

| Size | AITER Reg | AITER Unreg | vLLM Custom | Quick FP | Quick INT8 | Quick INT6 | Quick INT4 |
|---|---|---|---|---|---|---|---|
| 2KB | 1.54x | 2.01x | 2.49x | 2.96x | 2.28x | 2.16x | 2.27x |
| 32KB | 1.34x | 1.44x | 2.39x | 2.85x | 2.16x | 2.05x | 2.15x |
| 256KB | 2.08x | 1.96x | 2.44x | 2.67x | 2.17x | 2.06x | 2.17x |
| 512KB | 2.09x | 1.94x | 2.38x | 2.50x | 2.23x | 2.20x | 2.31x |
| 1MB | 1.86x | 1.73x | 2.05x | 2.18x | 2.17x | 2.23x | 2.40x |
| 2MB | 1.67x | 1.55x | 1.71x | 1.80x | 2.11x | 2.29x | 2.58x |
| 4MB | 1.46x | 1.41x | 1.52x | 1.55x | 2.17x | 2.45x | 2.91x |
| 8MB | 1.25x | 1.20x | 1.26x | 1.25x | 1.93x | 2.38x | 3.01x |
| 16MB | 1.14x | 1.11x | 1.12x | 1.10x | 1.83x | 2.31x | 2.96x |
| 32MB | 1.09x | 1.07x | 1.09x | 1.06x | 1.81x | 2.27x | 2.94x |
| 64MB | 1.06x | 1.04x | 1.05x | 1.03x | 1.80x | 2.30x | 3.11x |
| 128MB | 1.05x | 1.03x | 1.04x | 1.02x | 1.80x | 2.31x | 3.20x |
| 256MB | 1.02x | 1.00x | 1.01x | 1.00x | 1.77x | 2.27x | 3.17x |
| 512MB | 1.01x | 0.99x | 1.00x | 0.98x | 1.76x | 2.26x | 3.16x |
| 1GB | 1.01x | 0.98x | 0.99x | 0.98x | 1.75x | 2.25x | 3.15x |
| 2GB | 1.00x | 0.98x | 8051.21x | 0.98x | 1.75x | 2.25x | 3.16x |

# All-Reduce Benchmark Results (World Size: 4)

All times are in milliseconds. -1 indicates the method is not supported/available for that size.

| Size | NCCL | AITER Reg | AITER Unreg | vLLM Custom | Quick FP | Quick INT8 | Quick INT6 | Quick INT4 |
|---|---|---|---|---|---|---|---|---|
| 2KB | 0.209 | 0.079 | 0.065 | 0.037 | 0.033 | 0.042 | 0.045 | 0.042 |
| 32KB | 0.143 | 0.073 | 0.078 | 0.053 | 0.046 | 0.051 | 0.050 | 0.042 |
| 256KB | 0.104 | 0.040 | 0.045 | 0.037 | 0.033 | 0.042 | 0.044 | 0.042 |
| 512KB | 0.128 | 0.040 | 0.045 | 0.038 | 0.036 | 0.043 | 0.045 | 0.043 |
| 1MB | 0.112 | 0.046 | 0.050 | 0.045 | 0.041 | 0.049 | 0.048 | 0.045 |
| 2MB | 0.122 | 0.061 | 0.064 | 0.057 | 0.054 | 0.057 | 0.055 | 0.048 |
| 4MB | 0.162 | 0.082 | 0.087 | 0.083 | 0.084 | 0.081 | 0.070 | 0.059 |
| 8MB | 0.221 | 0.134 | 0.140 | 0.132 | 0.145 | 0.138 | 0.116 | 0.082 |
| 16MB | 0.289 | 0.240 | 0.247 | 0.238 | 0.262 | 0.243 | 0.199 | 0.146 |
| 32MB | 0.468 | 0.440 | 0.458 | 0.447 | 0.459 | 0.452 | 0.363 | 0.271 |
| 64MB | 0.838 | 0.856 | 0.885 | 0.864 | 0.842 | 0.712 | 0.571 | 0.426 |
| 128MB | 1.580 | 1.682 | 1.738 | 1.706 | 1.593 | 1.159 | 0.915 | 0.669 |
| 256MB | 3.045 | 3.368 | 3.464 | 3.400 | 3.101 | 2.016 | 1.586 | 1.170 |
| 512MB | 5.966 | 6.661 | 6.899 | 6.824 | 6.088 | 3.743 | 2.932 | 2.142 |
| 1GB | 11.753 | 13.334 | 13.829 | 13.749 | 12.091 | 7.241 | 5.632 | 4.094 |
| 2GB | 23.404 | 26.455 | 27.650 | 0.005 | 24.075 | 14.246 | 11.063 | 7.991 |

## Performance Summary

### Speedup vs NCCL

| Size | AITER Reg | AITER Unreg | vLLM Custom | Quick FP | Quick INT8 | Quick INT6 | Quick INT4 |
|---|---|---|---|---|---|---|---|
| 2KB | 2.64x | 3.22x | 5.57x | 6.24x | 4.92x | 4.67x | 4.96x |
| 32KB | 1.96x | 1.84x | 2.68x | 3.11x | 2.81x | 2.84x | 3.38x |
| 256KB | 2.58x | 2.30x | 2.82x | 3.18x | 2.46x | 2.35x | 2.44x |
| 512KB | 3.21x | 2.84x | 3.41x | 3.55x | 2.97x | 2.86x | 2.96x |
| 1MB | 2.43x | 2.25x | 2.47x | 2.69x | 2.30x | 2.35x | 2.49x |
| 2MB | 2.01x | 1.89x | 2.15x | 2.27x | 2.13x | 2.21x | 2.53x |
| 4MB | 1.97x | 1.86x | 1.94x | 1.93x | 2.00x | 2.31x | 2.73x |
| 8MB | 1.65x | 1.58x | 1.67x | 1.53x | 1.61x | 1.91x | 2.69x |
| 16MB | 1.20x | 1.17x | 1.21x | 1.10x | 1.19x | 1.45x | 1.97x |
| 32MB | 1.06x | 1.02x | 1.05x | 1.02x | 1.04x | 1.29x | 1.73x |
| 64MB | 0.98x | 0.95x | 0.97x | 1.00x | 1.18x | 1.47x | 1.97x |
| 128MB | 0.94x | 0.91x | 0.93x | 0.99x | 1.36x | 1.73x | 2.36x |
| 256MB | 0.90x | 0.88x | 0.90x | 0.98x | 1.51x | 1.92x | 2.60x |
| 512MB | 0.90x | 0.86x | 0.87x | 0.98x | 1.59x | 2.03x | 2.78x |
| 1GB | 0.88x | 0.85x | 0.85x | 0.97x | 1.62x | 2.09x | 2.87x |
| 2GB | 0.88x | 0.85x | 4335.26x | 0.97x | 1.64x | 2.12x | 2.93x |

# All-Reduce Benchmark Results (World Size: 8)

All times are in milliseconds. -1 indicates the method is not supported/available for that size.

| Size | NCCL | AITER Reg | AITER Unreg | vLLM Custom | Quick FP | Quick INT8 | Quick INT6 | Quick INT4 |
|---|---|---|---|---|---|---|---|---|
| 2KB | 0.165 | 0.075 | 0.070 | 0.037 | 0.036 | 0.047 | 0.050 | 0.047 |
| 32KB | 0.155 | 0.075 | 0.083 | 0.054 | 0.041 | 0.047 | 0.050 | 0.048 |
| 256KB | 0.106 | 0.042 | 0.047 | 0.038 | 0.036 | 0.047 | 0.049 | 0.047 |
| 512KB | 0.127 | 0.042 | 0.046 | 0.039 | 0.036 | 0.048 | 0.050 | 0.048 |
| 1MB | 0.133 | 0.043 | 0.047 | 0.047 | 0.039 | 0.051 | 0.051 | 0.049 |
| 2MB | 0.124 | 0.050 | 0.055 | 0.055 | 0.047 | 0.052 | 0.053 | 0.064 |
| 4MB | 0.148 | 0.067 | 0.071 | 0.076 | 0.069 | 0.065 | 0.074 | 0.069 |
| 8MB | 0.157 | 0.098 | 0.102 | 0.111 | 0.104 | 0.101 | 0.082 | 0.069 |
| 16MB | 0.245 | 0.161 | 0.177 | 0.178 | 0.173 | 0.216 | 0.163 | 0.111 |
| 32MB | 0.354 | 0.287 | 0.302 | 0.318 | 0.285 | 0.367 | 0.282 | 0.212 |
| 64MB | 0.511 | 0.540 | 0.572 | 0.596 | 0.494 | 0.544 | 0.417 | 0.333 |
| 128MB | 0.869 | 1.030 | 1.095 | 1.146 | 0.894 | 0.812 | 0.639 | 0.531 |
| 256MB | 1.605 | 2.038 | 2.149 | 2.269 | 1.685 | 1.331 | 1.117 | 0.977 |
| 512MB | 3.106 | 4.118 | 4.314 | 4.496 | 3.254 | 2.348 | 2.035 | 1.830 |
| 1GB | 6.175 | 7.961 | 8.654 | 8.987 | 6.409 | 4.394 | 3.898 | 3.560 |
| 2GB | 12.224 | 15.984 | 17.422 | 0.005 | 12.711 | 15.026 | 7.481 | 6.864 |

## Performance Summary

### Speedup vs NCCL

| Size | AITER Reg | AITER Unreg | vLLM Custom | Quick FP | Quick INT8 | Quick INT6 | Quick INT4 |
|---|---|---|---|---|---|---|---|
| 2KB | 2.18x | 2.36x | 4.49x | 4.51x | 3.49x | 3.31x | 3.50x |
| 32KB | 2.06x | 1.86x | 2.87x | 3.76x | 3.33x | 3.12x | 3.25x |
| 256KB | 2.55x | 2.26x | 2.81x | 2.95x | 2.25x | 2.15x | 2.25x |
| 512KB | 3.06x | 2.77x | 3.26x | 3.50x | 2.67x | 2.53x | 2.67x |
| 1MB | 3.13x | 2.82x | 2.83x | 3.40x | 2.62x | 2.59x | 2.69x |
| 2MB | 2.50x | 2.26x | 2.24x | 2.65x | 2.38x | 2.34x | 1.95x |
| 4MB | 2.20x | 2.08x | 1.95x | 2.15x | 2.28x | 2.00x | 2.13x |
| 8MB | 1.59x | 1.53x | 1.41x | 1.51x | 1.55x | 1.92x | 2.28x |
| 16MB | 1.52x | 1.38x | 1.38x | 1.42x | 1.13x | 1.51x | 2.21x |
| 32MB | 1.23x | 1.17x | 1.11x | 1.24x | 0.96x | 1.26x | 1.67x |
| 64MB | 0.95x | 0.89x | 0.86x | 1.03x | 0.94x | 1.23x | 1.54x |
| 128MB | 0.84x | 0.79x | 0.76x | 0.97x | 1.07x | 1.36x | 1.64x |
| 256MB | 0.79x | 0.75x | 0.71x | 0.95x | 1.21x | 1.44x | 1.64x |
| 512MB | 0.75x | 0.72x | 0.69x | 0.95x | 1.32x | 1.53x | 1.70x |
| 1GB | 0.78x | 0.71x | 0.69x | 0.96x | 1.41x | 1.58x | 1.73x |
| 2GB | 0.76x | 0.70x | 2273.44x | 0.96x | 0.81x | 1.63x | 1.78x |

